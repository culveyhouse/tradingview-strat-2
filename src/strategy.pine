// This Pine Script™ code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// © tradingview-strat-2

//@version=6
strategy("My Strategy", overlay=true, initial_capital=10000, default_qty_type=strategy.percent_of_equity, default_qty_value=100)

// ══════════════════════════════════════════════════════════════════════════════
// INPUTS
// ══════════════════════════════════════════════════════════════════════════════

// Strategy Parameters
i_enableLong = input.bool(true, "Enable Long Positions", group="Strategy Settings")
i_enableShort = input.bool(true, "Enable Short Positions", group="Strategy Settings")

// Indicator Parameters
i_fastLength = input.int(10, "Fast MA Length", minval=1, group="Indicator Settings")
i_slowLength = input.int(20, "Slow MA Length", minval=1, group="Indicator Settings")

// Risk Management
i_stopLossPerc = input.float(2.0, "Stop Loss %", minval=0.1, step=0.1, group="Risk Management")
i_takeProfitPerc = input.float(4.0, "Take Profit %", minval=0.1, step=0.1, group="Risk Management")

// ══════════════════════════════════════════════════════════════════════════════
// INDICATORS
// ══════════════════════════════════════════════════════════════════════════════

fastMA = ta.sma(close, i_fastLength)
slowMA = ta.sma(close, i_slowLength)

// ══════════════════════════════════════════════════════════════════════════════
// SIGNALS
// ══════════════════════════════════════════════════════════════════════════════

longCondition = ta.crossover(fastMA, slowMA)
shortCondition = ta.crossunder(fastMA, slowMA)

// ══════════════════════════════════════════════════════════════════════════════
// STRATEGY EXECUTION
// ══════════════════════════════════════════════════════════════════════════════

// Entry logic
if longCondition and i_enableLong
    strategy.entry("Long", strategy.long)

if shortCondition and i_enableShort
    strategy.entry("Short", strategy.short)

// Exit logic - placed outside entry conditions for proper execution
if strategy.position_size > 0
    strategy.exit("Long Exit", "Long", stop=close * (1 - i_stopLossPerc/100), limit=close * (1 + i_takeProfitPerc/100))

if strategy.position_size < 0
    strategy.exit("Short Exit", "Short", stop=close * (1 + i_stopLossPerc/100), limit=close * (1 - i_takeProfitPerc/100))

// ══════════════════════════════════════════════════════════════════════════════
// PLOTTING
// ══════════════════════════════════════════════════════════════════════════════

plot(fastMA, "Fast MA", color=color.blue, linewidth=2)
plot(slowMA, "Slow MA", color=color.red, linewidth=2)

// Plot entry signals
plotshape(longCondition, "Long Signal", shape.triangleup, location.belowbar, color.green, size=size.small)
plotshape(shortCondition, "Short Signal", shape.triangledown, location.abovebar, color.red, size=size.small)
